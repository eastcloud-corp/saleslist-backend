# 将来拡張要件定義

## 1. マルチテナント対応（Phase 3-4）

### 1.1 概要
- 複数の企業（テナント）が同一システムを利用
- テナント間のデータ完全分離
- テナントごとの独自設定・カスタマイズ

### 1.2 技術実装
- **データベース設計**
  - 全テーブルに`tenant_id`カラム追加
  - Row Level Security (RLS)による自動フィルタリング
  - テナント別データベーススキーマ分離も検討

- **API設計**
  - リクエストヘッダー: `X-Tenant-ID`
  - JWTトークンにテナント情報を含める
  - 全API呼び出しでテナントID検証

- **フロントエンド**
  - サブドメイン方式: `{tenant}.budget-sales.com`
  - または、パス方式: `/tenant/{tenant_id}/`

### 1.3 追加機能
- **テナント管理画面**
  - テナント作成・編集・削除
  - 利用ユーザー数制限設定
  - 機能制限設定
  
- **課金・プラン管理**
  - プラン別機能制限
  - 利用量課金システム
  - 請求書自動生成

### 1.4 データ構造例
```sql
-- テナントマスタ
tenants (
  id, name, domain, plan_type, max_users, 
  max_companies, features, created_at, is_active
)

-- 修正後の企業テーブル
companies (
  id, tenant_id, name, industry, ..., created_at
)
```

---

## 2. 外部システム連携（Phase 2-5）

### 2.1 メール送信機能
- **一斉メール送信**
  - 案件企業リストへの一斉メール配信
  - テンプレート管理
  - 配信結果トラッキング

- **技術実装**
  - SendGrid / AWS SES 連携
  - メール配信キュー管理
  - 開封率・クリック率計測

### 2.2 SNS API連携
- **Facebook Graph API**
  - プロフィール検索の自動化
  - メッセージ送信の自動化
  - 送信制限・レート制限管理

- **LinkedIn Sales Navigator API**
  - プロフィール検索
  - InMail送信
  - コネクション管理

### 2.3 外部CRM連携
- **Salesforce連携**
  - リード情報の同期
  - 商談情報の取得
  - 活動履歴の連携

- **HubSpot連携**
  - コンタクト情報同期
  - パイプライン管理
  - マーケティング自動化

### 2.4 Webhook機能
```javascript
// Webhook送信例
POST https://client-system.com/webhook/leads
{
  "event": "lead_created",
  "tenant_id": "tenant_123",
  "data": {
    "company_id": 1,
    "project_id": 5,
    "status": "返信あり",
    "contact_date": "2025-01-15"
  }
}
```

---

## 3. 権限管理システム（Phase 3）

### 3.1 ロールベースアクセス制御（RBAC）
- **管理者**: 全機能利用可能
- **営業マネージャー**: 案件管理、レポート閲覧
- **営業担当**: 担当案件のみ操作可能
- **閲覧専用**: データ参照のみ

### 3.2 権限設定
```sql
-- ロールマスタ
roles (
  id, name, description, permissions
)

-- ユーザーロール
user_roles (
  id, user_id, role_id, tenant_id, created_at
)

-- 権限チェック例
permissions = [
  "companies.read",
  "companies.write", 
  "projects.read",
  "projects.write",
  "projects.delete"
]
```

---

## 4. 高度な分析・レポート機能（Phase 4-5）

### 4.1 ダッシュボード機能
- **営業活動サマリー**
  - DM送信数、返信率、アポ獲得率
  - 案件別進捗状況
  - 担当者別パフォーマンス

- **業界別分析**
  - 業界別アプローチ成功率
  - 企業規模別反応率
  - 地域別傾向分析

### 4.2 AI活用機能
- **成功確率予測**
  - 企業属性から返信確率を予測
  - おすすめアプローチタイミング提案

- **文面最適化**
  - 過去の成功事例から最適なメッセージを提案
  - A/Bテスト機能

---

## 5. 自動化・効率化機能（Phase 2-4）

### 5.1 クローリング・データ収集自動化
- **求人サイト自動クローリング**
  - マイナビ、Indeed等からの企業情報収集
  - 新規企業の自動検出・候補リスト化

- **企業情報自動更新**
  - 企業HP監視による情報変更検知
  - 代表者変更の自動検出

### 5.2 SNS自動検索・アプローチ
- **Facebook自動検索**
  - 企業名+代表者名での自動検索
  - プロフィール候補の自動抽出・スコアリング

- **自動メッセージ送信**
  - 予約送信機能
  - 送信タイミング最適化
  - フォローアップメッセージ自動配信

---

## 6. システム拡張対応

### 6.1 マイクロサービス化
- **サービス分割**
  - 企業管理サービス
  - 案件管理サービス
  - 外部連携サービス
  - 通知サービス

- **API Gateway**
  - 認証・認可の統一管理
  - レート制限・負荷分散
  - ログ・監視の統一

### 6.2 スケーラビリティ対応
- **データベース**
  - 読み取り専用レプリカ
  - パーティショニング（テナント別、日付別）
  - Redis キャッシュ層

- **インフラ**
  - Kubernetes によるコンテナオーケストレーション
  - Auto Scaling 対応
  - CDN 活用

---

## 7. セキュリティ強化（Phase 3-4）

### 7.1 データ保護
- **個人情報保護**
  - 暗号化ストレージ
  - アクセスログ監査
  - データ保持期間管理

### 7.2 API セキュリティ
- **レート制限**
  - IP別、ユーザー別制限
  - API Key 管理

- **監視・アラート**
  - 異常アクセス検知
  - データ漏洩監視

---

## 8. モバイル対応（Phase 4-5）

### 8.1 モバイルアプリ
- **React Native アプリ**
  - 企業リスト閲覧
  - ステータス更新
  - プッシュ通知

### 8.2 PWA対応
- **オフライン機能**
  - データ同期機能
  - オフライン編集・後同期

---

## 実装優先順位

### Phase 1（現在）
- 基本的なCRUD機能
- 案件管理
- CSV インポート/エクスポート

### Phase 2（3-6ヶ月後）
- Facebook検索機能
- 自動クローリング
- メール送信機能

### Phase 3（6-12ヶ月後）
- マルチテナント対応
- 権限管理システム
- 基本的な外部API連携

### Phase 4（1-2年後）
- 高度な分析機能
- AI活用機能
- モバイル対応

### Phase 5（2年以上）
- マイクロサービス化
- 大規模スケーラビリティ対応
- 高度な自動化機能

この拡張計画により、段階的にAUTOBOOSTのような本格的なセールスプラットフォームへと発展させることが可能です。